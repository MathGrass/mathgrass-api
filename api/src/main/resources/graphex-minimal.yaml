swagger: "2.0"
info:
  description: "This is the MathGrass server.  You can find out more about Swagger at [http://swagger.io](http://swagger.io) or on [irc.freenode.net, #swagger](http://swagger.io/irc/). For this sample, you can use the api key `special-key` to test the authorization     filters."
  version: "1.0.0"
  title: "Swagger MathGrass"
  termsOfService: "http://swagger.io/terms/"
  contact:
    email: "apiteam@swagger.io"
  license:
    name: "Apache 2.0"
    url: "http://www.apache.org/licenses/LICENSE-2.0.html"
host: "mathgrass.swagger.io"
basePath: "/v2"

schemes:
- "https"
- "http"
paths:
  # GRAPH
  /graph/{graphId}:
    get:
      description: "Get a graph by id"
      operationId: "getGraphById"
      parameters:
      - name: "graphId"
        in: "path"
        description: "Graph id"
        required: true
        type: "integer"
        format: int64
      responses:
        "200":
          description: "successful operation"
          schema:
            $ref: "#/definitions/Graph"
  
  /graph:
    post:
      description: "Create a new graph"
      operationId: "createGraph"
      parameters:
      - name: "graph"
        in: "body"
        description: "Graph object that needs to be added to the store"
        required: true
        schema:
          $ref: "#/definitions/Graph"
      responses:
        "200":
          description: "successful operation"

  # TASK TEMPLATE
  /taskTemplate/{id}:
    get:
      description: "Returns a task template"
      operationId: "getTaskTemplateById"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/xml"
      - "application/json"
      responses:
        "200":
          description: "successful operation"
        "404":
          description: "Task Template not found"
      parameters:
      - name: "id"
        in: "path"
        description: "ID of task template"
        required: true
        type: "integer"
        format: int64


  /taskTemplate:
    post:
      description: "Creates a task template"
      operationId: "createTaskTemplate"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - in: "body"
        name: "taskTemplate"
        description: ""
        required: true
        schema:
          $ref: "#/definitions/TaskTemplate"
      responses:
        "200":
          description: "successful operation"

  /taskTemplate/{id}/setLabel:
    put:
      description: "Sets a label for a task template"
      operationId: "setTaskTemplateLabel"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/json"
      - "application/xml"
      parameters:
      - name: "id"
        in: "path"
        description: "ID of task template"
        required: true
        type: "integer"
        format: int64
      - name: "label"
        in: "body"
        description: "Label to set"
        required: true
        schema:
          type: "string"
      responses:
        "200":
          description: "successful operation"

  /taskTemplate/{id}/setQuestion:
    put:
      description: "Sets a question for a task template"
      operationId: "setTaskTemplateQuestion"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/xml"
      parameters:
      - in: "path"
        name: "id"
        description: "ID of task template"
        required: true
        type: "integer"
        format: int64
      - name: "question"
        in: "body"
        description: "Question to set"
        required: true
        schema:
          type: "string"
      responses:
        "200":
          description: "successful operation"
    

  # TASK
  /task/{id}:
    get:
      description: "Returns a task"
      operationId: "getTaskById"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - name: "id"
        in: "path"
        description: "ID of task"
        required: true
        type: "integer"
        format: int64
      responses:
        "200":
          description: "successful operation"
          schema:
            $ref: "#/definitions/Task"
    
  /task:
    post:
      description: "Creates a task"
      operationId: "createTask"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - in: "body"
        name: "task"
        description: ""
        required: true
        schema:
          $ref: "#/definitions/Task"
      responses:
        "200":
          description: "successful operation"
    
    put:
      description: "Updates a task"
      operationId: "updateTask"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - name: "id"
        in: "path"
        type: integer
        format: int64
        required: true
      - name: "task"
        in: "body"
        description: "ID of task"
        required: true
        schema:
          $ref: "#/definitions/Task"
      responses:
        "200":
          description: "successful operation"

  /task/{id}/addFeedback:
    post:
      description: "Adds feedback to a task"
      operationId: "addTaskFeedback"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - name: "id"
        in: "path"
        description: "ID of task"
        required: true
        type: "integer"
        format: int64
      responses:
        "200":
          description: "successful operation"


  /runTask/{id}:
    post:
      description: "Run a task with an answer"
      operationId: "runTask"
      consumes:
        - "application/json"
        - "application/xml"
      produces:
        - "application/xml"
        - "application/json"
      parameters:
        - name: "id"
          in: "path"
          description: "ID of task"
          required: true
          type: "integer"
          format: int64
        - name: "answer"
          in: "body"
          description: "Answer of student"
          required: true
          schema:
            type: "string"
      responses:
        "200":
          description: "successful operation"


  # TASK SOLVER    
  
  /taskSolver/{id}:
    get:
      description: "Returns a task solver"
      operationId: "getTaskSolverById"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - name: "id"
        in: "path"
        description: "ID of task solver"
        required: true
        type: "integer"
        format: int64
      responses:
        "200":
          description: "successful operation"

  /taskSolver:
    post:
      description: "Creates a task solver"
      operationId: "createTaskSolver"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - in: "body"
        name: "taskSolver"
        description: ""
        required: true
        schema:
          $ref: "#/definitions/TaskSolver"
      responses:
        "200":
          description: "successful operation"
  
  # TAG
  /tag/{id}:
    get:
      description: "Returns a tag"
      operationId: "getTagById"
      consumes:
      - "application/json"
      - "application/xml"
      produces:
      - "application/xml"
      - "application/json"
      parameters:
      - name: "id"
        in: "path"
        type: integer
        format: int64
        description: "ID of tag"
        required: true
      responses:
        "200":
          description: "successful operation"

securityDefinitions:
  mathgrass_auth:
    type: "oauth2"
    authorizationUrl: "http://mathgrass.swagger.io/oauth/dialog"
    flow: "implicit"
    scopes:
      write:exercising: "modify entities of exercising"
      read:exercising: "read exercising"
  api_key:
    type: "apiKey"
    name: "api_key"
    in: "header"
definitions:
  Graph:
    type: "object"
    properties:
      id:
        type: "integer"
        format: int64

      label:
        type: "string"
      tags:
        type: "array"
        items:
          $ref: "#/definitions/Tag"
      
      edges:
        type: "array"
        items:
          $ref: "#/definitions/Edge"
      vertices:
        type: "array"
        items:
          type: "integer"
          format: int64

  Edge:
    type: "object"
    properties:
      firstVertex:
        type: "integer"
        format: int64
      secondVertex:
        type: "integer"
        format: int64
  Tag:
    type: "object"
    properties:
      id:
        type: "integer"
        format: int64
      label:
        type: "string"

  TaskSolver:
    type: "object"
    properties:
      id:
        type: "integer"
        format: int64
      label:
        type: "string"
      executionDescriptor:
       type: "string"
  TaskTemplate:
    type: "object"
    properties:
      id:
        type: "integer"
        format: int64
      label:
        type: "string"
      question:
        type: "string"
      taskSolver:
        type: "string"
      hints:
        type: "string"
        additionalProperties:
          type: "string"
      tags:
        type: "array"
        items:
          $ref: "#/definitions/Tag"
  Task:
    type: "object"
    properties:
      id:
        type: "integer"
        format: int64
      template:
        $ref: "#/definitions/TaskTemplate"
      graph:
        $ref: "#/definitions/Graph"
      hints:
        type: "string"
        additionalProperties:
          type: "string"
      answer:
        type: "string"
      feedback:
        type: "array"
        items:
          $ref: "#/definitions/Feedback"
  Feedback:
    type: "object"
    properties:
      id:
        type: "integer"
        format: int64
      task:
        $ref: "#/definitions/Task"
      issue:
        type: "string"
  
  TaskTopic:
      type: "array"
      items:
        $ref: "#/definitions/TaskTemplate"

  TaskCollection:
    type: "object"
    properties:
      id:
        type: "integer"
        format: int64
      label:
        type: "string"
      tasks:
        type: "array"
        items:
          $ref: "#/definitions/Task"
  

externalDocs:
  description: "Find out more about Swagger"
  url: "http://swagger.io"